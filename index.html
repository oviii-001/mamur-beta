<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ржЕржнрж┐ржпрзЛржЧ ржмржХрзНрж╕ - Anonymous Complaint Box</title>
    <link rel="stylesheet" href="css/style.css?v=3.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body>
    <!-- Top Right Admin Link -->
    <div style="position: absolute; top: 15px; right: 20px; z-index: 1000;">
        <a href="login.html" style="color: #666; text-decoration: none; font-size: 11px; opacity: 0.4; font-family: 'Roboto', sans-serif;">Shit!!!</a>
    </div>
    
    <div class="container">
        <div class="content">
            <h1>ржЕржнрж┐ржпрзЛржЧ ржмржХрзНрж╕ ЁЯУЛ</h1>
            <h2>Anonymous Complaint Box</h2>
            <p>
                ржПржЗ ржмржХрзНрж╕рзЗ ржЖржкржирж┐ <span>@mamurbeta</span> ржПрж░ ржмрж┐рж░рзБржжрзНржзрзЗ ржпрзЗржХрзЛржирзЛ ржЕржнрж┐ржпрзЛржЧ, рж╕ржорж╛рж▓рзЛржЪржирж╛ ржмрж╛ ржкрж░рж╛ржорж░рзНрж╢ ржЬрж╛ржирж╛рждрзЗ ржкрж╛рж░рзЗржиред
                <br />ржЖржкржирж╛рж░ ржкрж░рж┐ржЪржпрж╝ рж╕ржорзНржкрзВрж░рзНржг ржЧрзЛржкржи ржерж╛ржХржмрзЗред ржирж┐ржГрж╕ржВржХрзЛржЪрзЗ рж╕рзО ржорждрж╛ржоржд ржжрж┐ржиред
                <br />Share your complaints, criticisms, or suggestions anonymously.
            </p>
            
            <form id="messageForm">
                <input
                    type="text"
                    id="nickname"
                    maxlength="30"
                    placeholder="ржЖржкржирж╛рж░ ржЫржжрзНржоржирж╛ржо"
                    class="nickname-input"
                />
                
                <textarea
                    id="messageText"
                    rows="6"
                    maxlength="1000"
                    placeholder="ржЖржкржирж╛рж░ ржЕржнрж┐ржпрзЛржЧ, рж╕ржорж╛рж▓рзЛржЪржирж╛ ржмрж╛ ржкрж░рж╛ржорж░рзНрж╢ ржПржЦрж╛ржирзЗ рж▓рж┐ржЦрзБржи... / Write your complaint, criticism or suggestion here..."
                    required
                ></textarea>
                
                <div class="char-count">
                    <span id="charCount">0</span> / 1000 characters
                </div>
                
                <button type="submit">ржЬржорж╛ ржжрж┐ржи / Submit</button>
            </form>

            <div id="statusMessage" class="status-message"></div>
        </div>
    </div>

    <!-- Firebase SDK v8 -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <script src="firebase-config.js?v=3.0"></script>
    <script>
        // Service Worker Registration for better cache control
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                        
                        // Listen for updates
                        registration.addEventListener('updatefound', function() {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', function() {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('ржирждрзБржи ржЖржкржбрзЗржЯ ржЙржкрж▓ржмрзНржз! ржкрзЗржЬ рж░рж┐ржлрзНрж░рзЗрж╢ ржХрж░ржмрзЗржи? / New update available! Refresh page?')) {
                                        newWorker.postMessage({type: 'SKIP_WAITING'});
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }

        // Cache busting - force fresh loads
        const cacheBuster = Date.now();
        console.log('Cache buster timestamp:', cacheBuster);
        
        // Wait for Firebase to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof firebase !== 'undefined' && firebase.apps.length > 0) {
                console.log('Firebase ready for message submission...');
            } else {
                console.error('Firebase not properly initialized');
            }
        });
    </script>
    <script src="js/main.js?v=3.0"></script>
</body>
</html>
